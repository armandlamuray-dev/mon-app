<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Personnalisation du th√®me</title>

  <style>
    body {
      background: #f7f3e8;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      text-align: center;
    }

    h1 {
      margin-top: 20px;
      color: #333;
    }

    .container {
      margin: 30px auto;
      width: 80%;
      max-width: 500px;
      background: white;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      text-align: left;
    }

    .preview {
      margin-top: 30px;
      padding: 20px;
      background: white;
      border-radius: 15px;
      width: 80%;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    label {
      font-weight: bold;
      display: block;
      margin-top: 15px;
    }

    input {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 8px;
      border: 1px solid #aaa;
    }

    button {
      margin-top: 25px;
      padding: 12px;
      width: 100%;
      background: #000;
      color: white;
      border-radius: 10px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
    }
  </style>
</head>

<body>

  <h1>üé® Personnalisez votre th√®me</h1>

  <div class="container">
    <label>Couleur du fond :</label>
    <input type="color" id="backgroundPicker" value="#f2e9d8">

    <label>Couleur des cartes :</label>
    <input type="color" id="cardColorPicker" value="#ffffff">

    <label>Arrondi des cartes (en px) :</label>
    <input type="number" id="radiusPicker" value="15">

    <button onclick="saveTheme()">Enregistrer le th√®me</button>
  </div>

  <div class="preview" id="previewBox">
    <h2>Aper√ßu</h2>
    <p>Ceci est un aper√ßu en direct de l‚Äôapparence de vos pages.</p>
  </div>

  <div style="margin: 20px;">
    <a href="user.html">‚¨Ö Retour</a>
  </div>

  <script>
    const user = JSON.parse(localStorage.getItem("user"));
    if (!user) {
      alert("Vous devez √™tre connect√©.");
      window.location.href = "login.html";
    }

    const backgroundInput = document.getElementById("backgroundPicker");
    const cardColorInput = document.getElementById("cardColorPicker");
    const radiusInput = document.getElementById("radiusPicker");
    const preview = document.getElementById("previewBox");

    function updatePreview() {
      document.body.style.background = backgroundInput.value;
      preview.style.background = cardColorInput.value;
      preview.style.borderRadius = radiusInput.value + "px";
    }

    backgroundInput.oninput = updatePreview;
    cardColorInput.oninput = updatePreview;
    radiusInput.oninput = updatePreview;

    async function saveTheme() {
      const theme = {
        background: backgroundInput.value,
        cardColor: cardColorInput.value,
        cardRadius: radiusInput.value + "px"
      };

      const res = await fetch("/user/theme", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
          id_user: user.id,
          theme
        })
      });

      alert("Th√®me enregistr√© !");
    }

    updatePreview();
  </script>

</body>
</html>
